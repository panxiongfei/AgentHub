# AgentHub å›å½’æµ‹è¯•ç³»ç»Ÿ

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

AgentHubå›å½’æµ‹è¯•ç³»ç»Ÿæ˜¯ä¸€ä¸ªå…¨é¢çš„è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ï¼Œæ—¨åœ¨ç¡®ä¿ç³»ç»Ÿåœ¨ä»»ä½•ä»£ç å˜æ›´åéƒ½èƒ½ä¿æŒç¨³å®šè¿è¡Œã€‚è¯¥ç³»ç»Ÿæ”¯æŒåå°å’Œå‰å°çš„å…¨æ–¹ä½æµ‹è¯•ï¼Œå¹¶å…·å¤‡è‡ªåŠ¨æ‰©å±•èƒ½åŠ›ã€‚

## ğŸ¯ æµ‹è¯•ç›®æ ‡

### æ ¸å¿ƒç›®æ ‡
- **ä¿è¯ç³»ç»ŸåŸºæœ¬åŠŸèƒ½æ­£å¸¸è¿ä½œ**
- **åŠæ—©å‘ç°ä»£ç å˜æ›´å¼•å…¥çš„é—®é¢˜**
- **æä¾›æŒç»­çš„ç³»ç»Ÿå¥åº·ç›‘æ§**
- **ç¡®ä¿AIç¼–ç¨‹çš„è´¨é‡å’Œæ•ˆç‡**

### æµ‹è¯•èŒƒå›´
1. **åå°æœåŠ¡æµ‹è¯•**
   - APIæœåŠ¡å¯åŠ¨å’Œå¥åº·æ£€æŸ¥
   - å¤§æ¨¡å‹è°ƒç”¨åŠŸèƒ½éªŒè¯
   - æ ¸å¿ƒAPIç«¯ç‚¹å“åº”æµ‹è¯•
   - æµè§ˆå™¨è‡ªåŠ¨åŒ–åŠŸèƒ½æµ‹è¯•
   - å†å²ä»»åŠ¡å’Œæ–‡ä»¶è®¿é—®æµ‹è¯•

2. **å‰å°åº”ç”¨æµ‹è¯•**
   - å‰ç«¯åº”ç”¨å¯è®¿é—®æ€§
   - é¡µé¢å¯¼èˆªåŠŸèƒ½
   - ç³»ç»ŸçŠ¶æ€æ˜¾ç¤º
   - å†å²ä»»åŠ¡æ˜¾ç¤ºåŠŸèƒ½

## ğŸ› ï¸ ç³»ç»Ÿæ¶æ„

### æ ¸å¿ƒç»„ä»¶

```
regression_test.py                    # ä¸»æµ‹è¯•æ‰§è¡Œå™¨
â”œâ”€â”€ AgentHubRegressionTest           # æµ‹è¯•æ§åˆ¶å™¨
â”œâ”€â”€ TestResult                       # æµ‹è¯•ç»“æœæ•°æ®ç»“æ„
â””â”€â”€ æµ‹è¯•æ–¹æ³•é›†åˆ
    â”œâ”€â”€ _run_backend_tests()         # åå°æµ‹è¯•é›†
    â”œâ”€â”€ _run_frontend_tests()        # å‰å°æµ‹è¯•é›†
    â””â”€â”€ _generate_test_report()      # æŠ¥å‘Šç”Ÿæˆå™¨

configs/regression_test_config.yaml  # æµ‹è¯•é…ç½®æ–‡ä»¶
â”œâ”€â”€ backend_tests                    # åå°æµ‹è¯•é…ç½®
â”œâ”€â”€ frontend_tests                   # å‰å°æµ‹è¯•é…ç½®
â”œâ”€â”€ auto_extension_rules            # è‡ªåŠ¨æ‰©å±•è§„åˆ™
â””â”€â”€ reporting                       # æŠ¥å‘Šé…ç½®

scripts/run_regression_test.sh      # è¿è¡ŒåŒ…è£…è„šæœ¬
â”œâ”€â”€ ç¯å¢ƒæ£€æŸ¥
â”œâ”€â”€ æœåŠ¡çŠ¶æ€æ£€æµ‹
â”œâ”€â”€ æµ‹è¯•æ‰§è¡Œ
â””â”€â”€ ç»“æœæ±‡æ€»
```

### æµ‹è¯•æµç¨‹

```mermaid
graph TD
    A[å¯åŠ¨å›å½’æµ‹è¯•] --> B[ç¯å¢ƒæ£€æŸ¥]
    B --> C[æœåŠ¡çŠ¶æ€æ£€æµ‹]
    C --> D[åå°æµ‹è¯•æ‰§è¡Œ]
    D --> E[å‰å°æµ‹è¯•æ‰§è¡Œ]
    E --> F[ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š]
    F --> G[ä¿å­˜ç»“æœ]
    G --> H[å‘é€é€šçŸ¥]
    H --> I[æµ‹è¯•å®Œæˆ]
    
    D --> D1[æœåŠ¡å¯åŠ¨æ£€æµ‹]
    D --> D2[å¤§æ¨¡å‹è°ƒç”¨æµ‹è¯•]
    D --> D3[APIç«¯ç‚¹æµ‹è¯•]
    D --> D4[æµè§ˆå™¨ä»»åŠ¡æµ‹è¯•]
    D --> D5[å†å²æ•°æ®æµ‹è¯•]
    
    E --> E1[å‰ç«¯è®¿é—®æµ‹è¯•]
    E --> E2[é¡µé¢å¯¼èˆªæµ‹è¯•]
    E --> E3[ç³»ç»ŸçŠ¶æ€æµ‹è¯•]
    E --> E4[å†å²æ˜¾ç¤ºæµ‹è¯•]
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ä½¿ç”¨

```bash
# ç›´æ¥è¿è¡ŒPythonè„šæœ¬
python regression_test.py

# ä½¿ç”¨åŒ…è£…è„šæœ¬ï¼ˆæ¨èï¼‰
./scripts/run_regression_test.sh

# æŸ¥çœ‹å¸®åŠ©
./scripts/run_regression_test.sh --help
```

### é«˜çº§ä½¿ç”¨

```bash
# ä¸åŒæ¨¡å¼æ‰§è¡Œ
./scripts/run_regression_test.sh manual     # æ‰‹åŠ¨æ¨¡å¼
./scripts/run_regression_test.sh scheduled # å®šæ—¶æ¨¡å¼
./scripts/run_regression_test.sh ci        # CI/CDæ¨¡å¼
```

### å‰ç½®æ¡ä»¶

ç¡®ä¿ä»¥ä¸‹æœåŠ¡æ­£åœ¨è¿è¡Œï¼š
1. **APIæœåŠ¡**: `python main.py serve` (ç«¯å£8000)
2. **å‰ç«¯æœåŠ¡**: `cd frontend && npm run dev` (ç«¯å£3001)
3. **Chromeè°ƒè¯•ä¼šè¯**: å¯åŠ¨Chromeè°ƒè¯•æ¨¡å¼ (ç«¯å£9222)

```bash
# å¯åŠ¨Chromeè°ƒè¯•ä¼šè¯
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome \
  --remote-debugging-port=9222 \
  --no-first-run \
  --no-default-browser-check &
```

## ğŸ“Š æµ‹è¯•ç»“æœè§£è¯»

### æˆåŠŸç‡æ ‡å‡†
- **ğŸ‰ ä¼˜ç§€**: æˆåŠŸç‡ â‰¥ 90%
- **âš ï¸ è‰¯å¥½**: æˆåŠŸç‡ â‰¥ 70%
- **ğŸš¨ éœ€è¦å…³æ³¨**: æˆåŠŸç‡ < 70%

### æµ‹è¯•æŠ¥å‘Šç»“æ„

```json
{
  "timestamp": "2025-06-01T19:32:15.690688",
  "summary": {
    "total_tests": 11,
    "successful_tests": 11,
    "failed_tests": 0,
    "success_rate": 1.0,
    "total_duration": 7.71
  },
  "categories": {
    "backend": {"total": 7, "successful": 7, "failed": 0},
    "frontend": {"total": 4, "successful": 4, "failed": 0}
  },
  "test_results": [...],  // è¯¦ç»†æµ‹è¯•ç»“æœ
  "failed_tests": [...]   // å¤±è´¥æµ‹è¯•è¯¦æƒ…
}
```

### æµ‹è¯•æŠ¥å‘Šå­˜å‚¨

- **è¯¦ç»†æŠ¥å‘Š**: `data/regression_tests/regression_test_YYYYMMDD_HHMMSS.json`
- **æœ€æ–°ç»“æœ**: `data/regression_tests/latest_result.json`
- **ä¿ç•™æœŸé™**: 30å¤©ï¼ˆå¯é…ç½®ï¼‰

## ğŸ”„ è‡ªåŠ¨æ‰©å±•åŠŸèƒ½

### æ‰©å±•è§„åˆ™

å›å½’æµ‹è¯•ç³»ç»Ÿå…·å¤‡æ™ºèƒ½æ‰©å±•èƒ½åŠ›ï¼Œä¼šè‡ªåŠ¨æ£€æµ‹ä»¥ä¸‹æ–°å¢åŠŸèƒ½å¹¶æ·»åŠ å¯¹åº”æµ‹è¯•ï¼š

1. **APIç«¯ç‚¹æ£€æµ‹**
   ```python
   # æ‰«ææ¨¡å¼
   @router.get("/api/v1/new_endpoint")
   # â†’ è‡ªåŠ¨æ·»åŠ ç«¯ç‚¹å“åº”æµ‹è¯•
   ```

2. **AIåŠŸèƒ½æ£€æµ‹**
   ```python
   # æ‰«ææ¨¡å¼
   async def new_ai_function(...) -> ModelResponse:
   # â†’ è‡ªåŠ¨æ·»åŠ AIåŠŸèƒ½æµ‹è¯•
   ```

3. **æµè§ˆå™¨åŠŸèƒ½æ£€æµ‹**
   ```python
   # æ‰«ææ¨¡å¼
   async def smart_new_operation(...)
   async def ai_enhanced_feature(...)
   # â†’ è‡ªåŠ¨æ·»åŠ æµè§ˆå™¨æ“ä½œæµ‹è¯•
   ```

4. **å¹³å°é›†æˆæ£€æµ‹**
   ```python
   # æ‰«ææ¨¡å¼
   class NewPlatform(BasePlatform):
   # â†’ è‡ªåŠ¨æ·»åŠ å¹³å°è¿æ¥æµ‹è¯•
   ```

### æ‰©å±•é…ç½®

åœ¨ `configs/regression_test_config.yaml` ä¸­é…ç½®è‡ªåŠ¨æ‰©å±•è§„åˆ™ï¼š

```yaml
auto_extension_rules:
  api_endpoint_detection:
    enabled: true
    scan_paths: ["app/api"]
    pattern: "@router\\.(get|post|put|delete)\\(['\"]([^'\"]+)['\"]"
    auto_add_basic_test: true
```

## ğŸ“… å®šæ—¶æ‰§è¡Œ

### å®šæ—¶ä»»åŠ¡é…ç½®

```bash
# æ·»åŠ åˆ°crontab
crontab -e

# æ¯å¤©8ç‚¹å’Œ20ç‚¹æ‰§è¡Œ
0 8,20 * * * cd /path/to/AgentHub && ./scripts/run_regression_test.sh scheduled
```

### è§¦å‘æ¡ä»¶

- **Gitæ¨é€å**: ä½¿ç”¨Git hooksè§¦å‘
- **éƒ¨ç½²æ—¶**: CI/CDæµæ°´çº¿é›†æˆ
- **æ‰‹åŠ¨æ‰§è¡Œ**: å¼€å‘è¿‡ç¨‹ä¸­ä¸»åŠ¨è¿è¡Œ
- **å®šæ—¶æ‰§è¡Œ**: ç³»ç»Ÿå®šæœŸå¥åº·æ£€æŸ¥

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **APIæœåŠ¡æœªå¯åŠ¨**
   ```bash
   # è§£å†³æ–¹æ¡ˆ
   python main.py serve &
   ```

2. **Chromeè°ƒè¯•ä¼šè¯ä¸å¯ç”¨**
   ```bash
   # è§£å†³æ–¹æ¡ˆ
   /Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome \
     --remote-debugging-port=9222 --no-first-run &
   ```

3. **å¤§æ¨¡å‹è°ƒç”¨å¤±è´¥**
   ```bash
   # æ£€æŸ¥APIå¯†é’¥
   export MODEL_GEMINI_API_KEY="your_api_key"
   ```

4. **å‰ç«¯æœåŠ¡ä¸å¯è®¿é—®**
   ```bash
   # å¯åŠ¨å‰ç«¯æœåŠ¡
   cd frontend && npm run dev
   ```

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
PYTHONPATH=. python regression_test.py --verbose

# åªè¿è¡Œç‰¹å®šç±»åˆ«çš„æµ‹è¯•
PYTHONPATH=. python regression_test.py --category backend
PYTHONPATH=. python regression_test.py --category frontend
```

## ğŸ“ˆ æ€§èƒ½ç›‘æ§

### å…³é”®æŒ‡æ ‡

- **æ‰§è¡Œæ—¶é—´**: é€šå¸¸ < 10ç§’
- **æˆåŠŸç‡**: ç›®æ ‡ > 90%
- **è¦†ç›–èŒƒå›´**: 11ä¸ªæ ¸å¿ƒæµ‹è¯•é¡¹
- **èµ„æºæ¶ˆè€—**: ä½å†…å­˜å’ŒCPUå ç”¨

### æ€§èƒ½ä¼˜åŒ–

1. **å¹¶å‘æ‰§è¡Œ**: ç‹¬ç«‹æµ‹è¯•é¡¹å¹¶è¡Œè¿è¡Œ
2. **ç¼“å­˜æœºåˆ¶**: å¤ç”¨æµè§ˆå™¨ä¼šè¯
3. **æ™ºèƒ½è·³è¿‡**: ä¾èµ–æœåŠ¡ä¸å¯ç”¨æ—¶è·³è¿‡ç›¸å…³æµ‹è¯•
4. **èµ„æºæ¸…ç†**: è‡ªåŠ¨æ¸…ç†ä¸´æ—¶èµ„æº

## ğŸš¨ æœ€ä½³å®è·µ

### å¼€å‘è€…æŒ‡å—

1. **æ¯æ¬¡ä»£ç å˜æ›´åç«‹å³è¿è¡Œå›å½’æµ‹è¯•**
   ```bash
   # å¼€å‘æµç¨‹
   git add .
   ./scripts/run_regression_test.sh  # ç¡®ä¿æµ‹è¯•é€šè¿‡
   git commit -m "feature: æ–°åŠŸèƒ½å®ç°"
   ```

2. **æ–°åŠŸèƒ½å¼€å‘æ—¶åŒæ­¥æ·»åŠ æµ‹è¯•**
   - æ›´æ–° `configs/regression_test_config.yaml`
   - æ·»åŠ å¯¹åº”çš„æµ‹è¯•é€»è¾‘
   - éªŒè¯æµ‹è¯•è¦†ç›–å®Œæ•´æ€§

3. **æµ‹è¯•å¤±è´¥æ—¶çš„å¤„ç†æµç¨‹**
   - ä¸è¦å¿½ç•¥æµ‹è¯•å¤±è´¥
   - ä»”ç»†åˆ†æå¤±è´¥åŸå› 
   - ä¿®å¤é—®é¢˜åé‡æ–°è¿è¡Œ
   - ç¡®ä¿é€šè¿‡åå†æäº¤ä»£ç 

### CI/CDé›†æˆ

```yaml
# GitHub Actions ç¤ºä¾‹
name: Regression Tests
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run Regression Tests
        run: |
          ./scripts/run_regression_test.sh ci
          if [ $? -ne 0 ]; then
            echo "å›å½’æµ‹è¯•å¤±è´¥ï¼Œé˜»æ­¢åˆå¹¶"
            exit 1
          fi
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®å¼€å‘è§„èŒƒ](../éœ€æ±‚.md#å¼€å‘è§„èŒƒ)
- [APIæ–‡æ¡£](api.md)
- [æµè§ˆå™¨è‡ªåŠ¨åŒ–æŒ‡å—](browser_automation.md)
- [AIé›†æˆæ–‡æ¡£](ai_integration.md)

## ğŸ”„ ç‰ˆæœ¬å†å²

- **v1.0**: åŸºç¡€å›å½’æµ‹è¯•æ¡†æ¶
- **v1.1**: æ·»åŠ AIåŠŸèƒ½æµ‹è¯•
- **v1.2**: å¢åŠ æµè§ˆå™¨è‡ªåŠ¨åŒ–æµ‹è¯•
- **v2.0**: å®Œæ•´çš„è‡ªåŠ¨æ‰©å±•ç³»ç»Ÿ
- **v2.1**: å®šæ—¶æ‰§è¡Œå’ŒCI/CDé›†æˆ

---

**é‡è¦æé†’**: å›å½’æµ‹è¯•æ˜¯ç¡®ä¿AgentHubç³»ç»Ÿç¨³å®šæ€§çš„å…³é”®å·¥å…·ã€‚æ¯ä¸ªå¼€å‘è€…éƒ½åº”è¯¥ç†Ÿæ‚‰å…¶ä½¿ç”¨æ–¹æ³•ï¼Œå¹¶ä¸¥æ ¼éµå¾ª"æµ‹è¯•å…ˆè¡Œ"çš„å¼€å‘åŸåˆ™ã€‚ 